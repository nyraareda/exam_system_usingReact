

Tue Jun 18 20:30:30 2024
Command line: TestDisk

TestDisk 7.1, Data Recovery Utility, July 2019
Christophe GRENIER <grenier@cgsecurity.org>
https://www.cgsecurity.org
OS: Linux, kernel 6.5.0-35-generic (#35~22.04.1-Ubuntu SMP PREEMPT_DYNAMIC Tue May  7 09:00:52 UTC 2) x86_64
Compiler: GCC 13.2
ext2fs lib: 1.47.0, ntfs lib: libntfs-3g, reiserfs lib: none, ewf lib: none, curses lib: ncurses 6.4
Warning: can't get size for Disk /dev/mapper/control - 0 B - 0 sectors, sector size=512
Warning: can't get size for Disk /dev/loop51 - 0 B - 0 sectors, sector size=512
Hard disk list
Disk /dev/loop0 - 4096 B - 8 sectors (RO), sector size=512
Disk /dev/loop1 - 179 MB / 171 MiB - 351480 sectors (RO), sector size=512
Disk /dev/loop10 - 77 MB / 74 MiB - 151992 sectors (RO), sector size=512
Disk /dev/loop11 - 77 MB / 74 MiB - 152040 sectors (RO), sector size=512
Disk /dev/loop12 - 69 MB / 66 MiB - 135520 sectors (RO), sector size=512
Disk /dev/loop13 - 69 MB / 66 MiB - 135328 sectors (RO), sector size=512
Disk /dev/loop14 - 69 MB / 66 MiB - 136248 sectors (RO), sector size=512
Disk /dev/loop15 - 111 MB / 106 MiB - 218600 sectors (RO), sector size=512
Disk /dev/loop16 - 111 MB / 106 MiB - 218608 sectors (RO), sector size=512
Disk /dev/loop17 - 124 MB / 119 MiB - 243928 sectors (RO), sector size=512
Disk /dev/loop18 - 124 MB / 119 MiB - 243888 sectors (RO), sector size=512
Disk /dev/loop19 - 283 MB / 270 MiB - 554392 sectors (RO), sector size=512
Disk /dev/loop2 - 179 MB / 171 MiB - 351408 sectors (RO), sector size=512
Disk /dev/loop20 - 282 MB / 269 MiB - 551896 sectors (RO), sector size=512
Disk /dev/loop21 - 540 MB / 515 MiB - 1056096 sectors (RO), sector size=512
Disk /dev/loop22 - 172 MB / 164 MiB - 337560 sectors (RO), sector size=512
Disk /dev/loop23 - 366 MB / 349 MiB - 716176 sectors (RO), sector size=512
Disk /dev/loop24 - 509 MB / 485 MiB - 994336 sectors (RO), sector size=512
Disk /dev/loop25 - 529 MB / 505 MiB - 1034424 sectors (RO), sector size=512
Disk /dev/loop26 - 143 KB / 140 KiB - 280 sectors (RO), sector size=512
Disk /dev/loop27 - 96 MB / 91 MiB - 187776 sectors (RO), sector size=512
Disk /dev/loop28 - 127 MB / 121 MiB - 249432 sectors (RO), sector size=512
Disk /dev/loop29 - 128 MB / 123 MiB - 251936 sectors (RO), sector size=512
Disk /dev/loop3 - 327 MB / 312 MiB - 639256 sectors (RO), sector size=512
Disk /dev/loop30 - 459 MB / 438 MiB - 897608 sectors (RO), sector size=512
Disk /dev/loop31 - 465 MB / 443 MiB - 909296 sectors (RO), sector size=512
Disk /dev/loop32 - 34 MB / 33 MiB - 68328 sectors (RO), sector size=512
Disk /dev/loop33 - 34 MB / 33 MiB - 68208 sectors (RO), sector size=512
Disk /dev/loop34 - 603 MB / 575 MiB - 1178776 sectors (RO), sector size=512
Disk /dev/loop35 - 277 MB / 264 MiB - 541200 sectors (RO), sector size=512
Disk /dev/loop36 - 181 MB / 173 MiB - 354320 sectors (RO), sector size=512
Disk /dev/loop37 - 181 MB / 173 MiB - 354352 sectors (RO), sector size=512
Disk /dev/loop38 - 452 MB / 431 MiB - 884528 sectors (RO), sector size=512
Disk /dev/loop39 - 453 MB / 432 MiB - 884888 sectors (RO), sector size=512
Disk /dev/loop4 - 327 MB / 312 MiB - 639248 sectors (RO), sector size=512
Disk /dev/loop40 - 13 MB / 12 MiB - 26472 sectors (RO), sector size=512
Disk /dev/loop41 - 12 MB / 12 MiB - 25240 sectors (RO), sector size=512
Disk /dev/loop42 - 40 MB / 38 MiB - 79328 sectors (RO), sector size=512
Disk /dev/loop43 - 40 MB / 38 MiB - 79520 sectors (RO), sector size=512
Disk /dev/loop44 - 487 KB / 476 KiB - 952 sectors (RO), sector size=512
Disk /dev/loop45 - 462 KB / 452 KiB - 904 sectors (RO), sector size=512
Disk /dev/loop46 - 90 MB / 86 MiB - 177368 sectors (RO), sector size=512
Disk /dev/loop47 - 90 MB / 86 MiB - 177360 sectors (RO), sector size=512
Disk /dev/loop48 - 467 MB / 445 MiB - 912736 sectors (RO), sector size=512
Disk /dev/loop49 - 336 MB / 321 MiB - 657616 sectors (RO), sector size=512
Disk /dev/loop5 - 109 MB / 103 MiB - 212976 sectors (RO), sector size=512
Disk /dev/loop50 - 293 MB / 280 MiB - 573672 sectors (RO), sector size=512
Disk /dev/loop6 - 58 MB / 55 MiB - 113992 sectors (RO), sector size=512
Disk /dev/loop7 - 58 MB / 55 MiB - 113992 sectors (RO), sector size=512
Disk /dev/loop8 - 67 MB / 63 MiB - 130960 sectors (RO), sector size=512
Disk /dev/loop9 - 67 MB / 63 MiB - 130960 sectors (RO), sector size=512
Disk /dev/nvme0n1 - 512 GB / 476 GiB - CHS 488386 64 32, sector size=512

Partition table type (auto): EFI GPT
Disk /dev/nvme0n1 - 512 GB / 476 GiB
Partition table type: EFI GPT

Analyse Disk /dev/nvme0n1 - 512 GB / 476 GiB - CHS 488386 64 32
hdr_size=92
hdr_lba_self=1
hdr_lba_alt=1000215215 (expected 1000215215)
hdr_lba_start=34
hdr_lba_end=1000215182
hdr_lba_table=2
hdr_entries=128
hdr_entsz=128
check_part_gpt failed for partition
 2 P MS Reserved               534528     567295      32768 [Microsoft reserved partition]
Current partition structure:
 1 P EFI System                  2048     534527     532480 [EFI system partition]
No FAT, NTFS, ext2, JFS, Reiser, cramfs or XFS marker
 2 P MS Reserved               534528     567295      32768 [Microsoft reserved partition]
 2 P MS Reserved               534528     567295      32768 [Microsoft reserved partition]
Warning: number of heads/cylinder mismatches 255 (NTFS) != 64 (HD)
Warning: number of sectors per track mismatches 63 (NTFS) != 32 (HD)
 3 P MS Data                   567296  604022651  603455356 [Basic data partition] [OS]
 4 P Windows Recovery Env   997736448  999682047    1945600 [Basic data partition]
 5 P Windows Recovery Env   999682048 1000214527     532480 [Basic data partition]
 6 P Linux filesys. data    604022784  997736447  393713664

search_part()
Disk /dev/nvme0n1 - 512 GB / 476 GiB - CHS 488386 64 32
FAT32 at 1/0/1
FAT1 : 7166-7678
FAT2 : 7679-8191
start_rootdir : 8192 root cluster : 2
Data : 8192-532479
sectors : 532480
cluster_size : 8
no_of_cluster : 65536 (2 - 65537)
fat_length 513 calculated 513
heads/cylinder 255 (FAT) != 64 (HD)
sect/track 63 (FAT) != 32 (HD)

FAT32 at 1/0/1
FAT: cluster=2(0x2), pos=10240
     EFI System                  2048     534527     532480 [EFI System Partition] [SYSTEM]
     FAT32, blocksize=4096, 272 MB / 260 MiB
NTFS at 277/0/1
heads/cylinder 255 (NTFS) != 64 (HD)
sect/track 63 (NTFS) != 32 (HD)
filesystem size           603455353
sectors_per_cluster       8
mft_lcn                   786432
mftmirr_lcn               2
clusters_per_mft_record   -10
clusters_per_index_record 1
NTFS part_offset=290455552, part_size=308969140736, sector_size=512
NTFS partition cannot be added (part_offset<part_size).
NTFS at 277/0/1
heads/cylinder 255 (NTFS) != 64 (HD)
sect/track 63 (NTFS) != 32 (HD)
filesystem size           603455353
sectors_per_cluster       8
mft_lcn                   786432
mftmirr_lcn               2
clusters_per_mft_record   -10
clusters_per_index_record 1
     MS Data                   567296  604022648  603455353 [OS]
     NTFS, blocksize=4096, 308 GB / 287 GiB
NTFS at 294932/59/28
heads/cylinder 255 (NTFS) != 64 (HD)
sect/track 63 (NTFS) != 32 (HD)
filesystem size           603455353
sectors_per_cluster       8
mft_lcn                   786432
mftmirr_lcn               2
clusters_per_mft_record   -10
clusters_per_index_record 1
     MS Data                   567299  604022651  603455353
     NTFS found using backup sector, blocksize=4096, 308 GB / 287 GiB
NTFS at 294932/59/28
heads/cylinder 255 (NTFS) != 64 (HD)
sect/track 63 (NTFS) != 32 (HD)
filesystem size           603455353
sectors_per_cluster       8
mft_lcn                   786432
mftmirr_lcn               2
clusters_per_mft_record   -10
clusters_per_index_record 1
     MS Data                604022651 1207478003  603455353
     NTFS, blocksize=4096, 308 GB / 287 GiB
This partition ends after the disk limits. (start=604022651, size=603455353, end=1207478003, disk end=1000215216)

recover_EXT2: s_block_group_nr=0/1501, s_mnt_count=125/4294967295, s_blocks_per_group=32768, s_inodes_per_group=8192
recover_EXT2: s_blocksize=4096
recover_EXT2: s_blocks_count 49214208
recover_EXT2: part_size 393713664
Filesystem created: Mon Apr  1 16:19:17 2024
Last mount time:    Tue Jun 18 11:41:22 2024
     Linux filesys. data    604022784  997736447  393713664
     ext4 blocksize=4096 Large_file Sparse_SB Recover, 201 GB / 187 GiB
NTFS at 487176/0/1
heads/cylinder 255 (NTFS) != 64 (HD)
sect/track 63 (NTFS) != 32 (HD)
filesystem size           1945600
sectors_per_cluster       8
mft_lcn                   81066
mftmirr_lcn               2
clusters_per_mft_record   -10
clusters_per_index_record 1
     MS Data                995790849  997736448    1945600
     NTFS found using backup sector, blocksize=4096, 996 MB / 950 MiB
NTFS at 487176/0/1
heads/cylinder 255 (NTFS) != 64 (HD)
sect/track 63 (NTFS) != 32 (HD)
filesystem size           1945600
sectors_per_cluster       8
mft_lcn                   81066
mftmirr_lcn               2
clusters_per_mft_record   -10
clusters_per_index_record 1
     MS Data                997736448  999682047    1945600 [RECOVERY]
     NTFS, blocksize=4096, 996 MB / 950 MiB
FAT32 at 488126/0/1
FAT1 : 7166-7678
FAT2 : 7679-8191
start_rootdir : 8192 root cluster : 2
Data : 8192-532479
sectors : 532480
cluster_size : 8
no_of_cluster : 65536 (2 - 65537)
fat_length 513 calculated 513
heads/cylinder 255 (FAT) != 64 (HD)
sect/track 63 (FAT) != 32 (HD)

FAT32 at 488126/0/1
FAT: cluster=2(0x2), pos=999690240
     MS Data                999682048 1000214527     532480 [MYASUS]
     FAT32, blocksize=4096, 272 MB / 260 MiB
NTFS at 488386/20/15
heads/cylinder 255 (NTFS) != 64 (HD)
sect/track 63 (NTFS) != 32 (HD)
filesystem size           999647887
sectors_per_cluster       8
mft_lcn                   786432
mftmirr_lcn               2
clusters_per_mft_record   -10
clusters_per_index_record 1
     MS Data                   567296 1000215182  999647887 [OS]
     NTFS found using backup sector, blocksize=4096, 511 GB / 476 GiB
NTFS at 488386/20/15
heads/cylinder 255 (NTFS) != 64 (HD)
sect/track 63 (NTFS) != 32 (HD)
filesystem size           999647887
sectors_per_cluster       8
mft_lcn                   786432
mftmirr_lcn               2
clusters_per_mft_record   -10
clusters_per_index_record 1
NTFS: Can't read MFT
     MS Data               1000215182 1999863068  999647887
     NTFS, blocksize=4096, 511 GB / 476 GiB
This partition ends after the disk limits. (start=1000215182, size=999647887, end=1999863068, disk end=1000215216)
Disk /dev/nvme0n1 - 512 GB / 476 GiB - CHS 488386 64 32
Check the harddisk size: HD jumper settings, BIOS detection...
The harddisk (512 GB / 476 GiB) seems too small! (< 1023 GB / 953 GiB)
The following partitions can't be recovered:
     MS Data                604022651 1207478003  603455353
     NTFS, blocksize=4096, 308 GB / 287 GiB
     MS Data               1000215182 1999863068  999647887
     NTFS, blocksize=4096, 511 GB / 476 GiB

Results
   P EFI System                  2048     534527     532480 [EFI System Partition] [SYSTEM]
     FAT32, blocksize=4096, 272 MB / 260 MiB
     MS Data                   567296  604022648  603455353 [OS]
     NTFS, blocksize=4096, 308 GB / 287 GiB
     MS Data                   567296 1000215182  999647887 [OS]
     NTFS found using backup sector, blocksize=4096, 511 GB / 476 GiB
     MS Data                   567299  604022651  603455353
     NTFS found using backup sector, blocksize=4096, 308 GB / 287 GiB
     Linux filesys. data    604022784  997736447  393713664
     ext4 blocksize=4096 Large_file Sparse_SB Recover, 201 GB / 187 GiB
     MS Data                995790849  997736448    1945600
     NTFS found using backup sector, blocksize=4096, 996 MB / 950 MiB
     MS Data                997736448  999682047    1945600 [RECOVERY]
     NTFS, blocksize=4096, 996 MB / 950 MiB
     MS Data                999682048 1000214527     532480 [MYASUS]
     FAT32, blocksize=4096, 272 MB / 260 MiB

Hint for advanced users: dmsetup may be used if you prefer to avoid rewriting the partition table for the moment:
echo "0 532480 linear /dev/nvme0n1 2048" | dmsetup create test0
echo "0 603455353 linear /dev/nvme0n1 567296" | dmsetup create test1
echo "0 999647887 linear /dev/nvme0n1 567296" | dmsetup create test2
echo "0 603455353 linear /dev/nvme0n1 567299" | dmsetup create test3
echo "0 393713664 linear /dev/nvme0n1 604022784" | dmsetup create test4
echo "0 1945600 linear /dev/nvme0n1 995790849" | dmsetup create test5
echo "0 1945600 linear /dev/nvme0n1 997736448" | dmsetup create test6
echo "0 532480 linear /dev/nvme0n1 999682048" | dmsetup create test7

interface_write()
 1 P EFI System                  2048     534527     532480 [EFI System Partition] [SYSTEM]

interface_write()
 1 P EFI System                  2048     534527     532480 [EFI System Partition] [SYSTEM]

interface_write()
 1 P EFI System                  2048     534527     532480 [EFI System Partition] [SYSTEM]

interface_write()
 1 P EFI System                  2048     534527     532480 [EFI System Partition] [SYSTEM]

interface_write()
 1 P EFI System                  2048     534527     532480 [EFI System Partition] [SYSTEM]
SIGINT detected! TestDisk has been killed.
